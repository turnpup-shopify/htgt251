{% comment %}

Should include all information about how to install this when someone buys it. 
- Docs: https://kenwheeler.github.io/slick/
- Requires: Jquery 1.7+
	<script type="text/javascript" src="//code.jquery.com/jquery-1.11.0.min.js"></script>
	<script type="text/javascript" src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>

in theme.liquid head
	<!-- Add the slick-theme.css if you want default styling -->
	<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/kenwheeler/slick@1.8.0/slick/slick.css"/>
	<!-- Add the slick-theme.css if you want default styling -->
	<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/kenwheeler/slick@1.8.0/slick/slick-theme.css"/>
	<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/kenwheeler/slick@1.8.0/slick/slick.min.js"></script>

{% endcomment %}

{% schema %}
  {
    "name": "Social Proof",
    "class": "social-proof-section",
    "settings": [
      {
        "type": "header",
        "content": "Module Global Settings"
      },
      {
        "type": "range",
        "id": "padding_top",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "Section Padding Top",
        "default": 0
      },
      {
        "type": "range",
        "id": "padding_bottom",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "Section Padding Buttom",
        "default": 0
      },
      {
        "type": "range",
        "id": "padding_right",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "Section Padding Right",
        "default": 40
      }, {
        "type": "range",
        "id": "padding_left",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "section Padding Left",
        "default": 40
      }, {
        "type": "range",
        "id": "mobile_padding_top",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "Mobile Section Padding Top",
        "default": 0
      }, {
        "type": "range",
        "id": "mobile_padding_bottom",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "Mobile Section Padding Buttom",
        "default": 0
      }, {
        "type": "range",
        "id": "mobile_padding_right",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "Mobile Section Padding Right",
        "default": 0
      }, {
        "type": "range",
        "id": "mobile_padding_left",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "Mobile section Padding Left",
        "default": 20
      },
      {
      "type": "header",
      "content": "Colors",
      "info": "_"
    },
    {
      "type": "text",
      "id": "desktop_actual_quote_font_size",
      "label": "Desktop Actual Quote Font Size",
      "default": "24px"  
    },
    {
      "type": "text",
      "id": "mobile_actual_quote_font_size",
      "label": "Mobile Actual Quote Font Size",
      "default": "24px"
    },
    {
      "type": "text",
      "id": "desktop_quote_size",
      "label": "Desktop Actual Quote Font Size",
      "default": "24px"  
    },
    {
      "type": "text",
      "id": "mobile_quote_size",
      "label": "Mobile Actual Quote Font Size",
      "default": "24px"
    },    
    {
      "type": "checkbox",
      "id": "hide_quote_on_mobile",
      "label": "Hide Quote Icon on Mobile", 
      "default": false
    },
    {
			"type": "color",
			"id": "module_background_color",
			"label": "Module Background Color",
			"default": "#0c2a4a"
		},
		{
			"type": "color",
			"id": "module_accent_color",
			"label": "Module Accent Color",
			"default": "#B4ECFF"
		},
    {
      "type": "color",
      "id": "quote_color",
      "label": "Quote Text Color",
      "default": "#FFFFFF"
    },
    {
      "type": "color",
      "id": "dots_unselected_color",
      "label": "Dots Unselected Color",
      "default": "#FFFFFF"
    },
		{
			"type": "color",
			"id": "turnpup_bottom_border_color",
			"label": "Bottom Border Color",
			"default": "#F4B237"
		},
    {
      "type": "header",
      "content": "Fonts",
      "info": "_"
    },
    {
      "type": "text",
      "id": "quote_font_family",
      "label": "Quote Font Family",
      "default": "Helvetica Neue"
    },
    {
      "type": "text",
      "id": "who_said_it_font_family",
      "label": "Who Said it Font Family",
      "default": "Helvetica Neue"
    },
    {
      "type": "text",
      "id": "stars",
      "label": "★★★★★",
      "default": "Stars"
    }
	],
	"blocks": [
		{
			"name": "Social Proof",
			"type": "space",
			"settings": [
				{
					"type": "header",
					"content": "Quote",
					"info": "_"
				},
				{
					"type": "text",
					"id": "quote_text",
					"label": "Quote",
					"default": "The best product I've ever used."
				},
				{
					"type": "text",
					"id": "who_said_it",
					"label": "Who Said It?",
					"default": "Vanity Fair"
				}
			]
		}
    ],
    "presets": [
      {
        "name": "Social Proof",
        "category": "Advanced layout",
        "blocks": [

        ]
      }
    ]
  }
{% endschema %}



<div class="social-proof" data-section-id="{{ section.id }}" data-section-type="social-proof-section">
  <div class="quote-slider">
    <div class="actual-quote">
      <svg width="18" height="16" viewBox="0 0 32 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M0.820312 21.4437C0.820312 25.6437 1.22032 26.0437 5.12032 26.0437H10.4203C14.0203 26.0437 14.5203 25.5437 14.5203 22.0437V15.8437C14.5203 12.5437 14.1203 12.1437 11.4203 11.9437C9.92032 11.9437 9.42032 11.2437 9.42032 9.44368C9.42032 7.04368 10.5203 5.54368 13.2203 4.44368C14.2203 4.04367 14.5203 3.54367 14.5203 2.54368C14.5203 1.04368 13.6203 0.143677 12.1203 0.143677C8.92031 0.143677 6.22032 1.34367 4.12032 3.64367C1.92032 6.04368 0.820312 9.74368 0.820312 14.9437V21.4437ZM18.8203 21.4437C18.8203 25.6437 19.2203 26.0437 23.1203 26.0437H28.4203C32.0203 26.0437 32.5203 25.5437 32.5203 22.0437V15.8437C32.5203 12.5437 32.1203 12.1437 29.4203 11.9437C27.9203 11.9437 27.4203 11.2437 27.4203 9.44368C27.4203 7.04368 28.5203 5.54368 31.2203 4.44368C32.2203 4.04367 32.5203 3.54367 32.5203 2.54368C32.5203 1.04368 31.6203 0.143677 30.1203 0.143677C26.9203 0.143677 24.2203 1.34367 22.1203 3.64367C19.9203 6.04368 18.8203 9.74368 18.8203 14.9437V21.4437Z" fill="{{ section.settings.module_accent_color }}"></path>
      </svg> 
    </div>
    <div class="quote-slider-container" data-current="0">
      <div class="quote-slides">
        {% for block in section.blocks %}   
          <div class="quote-slide"> 
            <div class="quote"> {{ block.settings.quote_text }} </div>
            {% if block.settings.who_said_it != blank %} 
              <div class="who_said_it"> {{ block.settings.who_said_it }}</div> 
              <div class="who_said_it stars"> {{ block.settings.stars | default: '★★★★★' }}</div> 
            {% endif %}
          </div>
        {% endfor %}
      </div>
      <div class="quote-nav">
        <button class="quote-prev">‹</button>
        <button class="quote-next">›</button>
      </div>
      <div class="quote-dots">
        {% for block in section.blocks %}
          <span class="quote-dot" data-index="{{ forloop.index0 }}"></span>
        {% endfor %}
      </div>
    </div>
  </div>
</div>
<style>
  .social-proof {
    background-color: {{ section.settings.module_background_color }};
  }
  .social-proof {
      padding-top: {{ section.settings.mobile_padding_top }}px;
      padding-right: {{ section.settings.mobile_padding_right }}px;
      padding-left: {{ section.settings.mobile_padding_left }}px;
      padding-bottom: {{ section.settings.mobile_padding_bottom }}px;
    }
    @media screen and (min-width: 700px) {
      .social-proof {
        padding-top: {{ section.settings.padding_top }}px;
        padding-right: {{ section.settings.padding_right }}px;
        padding-left: {{ section.settings.padding_left }}px;
        padding-bottom: {{ section.settings.padding_bottom }}px;
      }
    }
  .actual-quote {
    margin: 0 auto 2rem;
    text-align: left;
  }
  .quote-slide {
    display: none;
    font-size: {{ section.settings.desktop_actual_quote_font_size }};
    text-align: left;
    margin: 0 auto;
    font-family: {{ section.settings.quote_font_family }} !important;
    font-weight: 400;
    line-height:  1.1;
    color:  {{ section.settings.quote_color }};
    margin-bottom: 20px;
  }
  .quote-slide .who_said_it {
    color:  {{ section.settings.quote_color }};
    font-size: {{ section.settings.desktop_quote_size }};
    text-align: left;
    margin: 0 auto;
    font-family: 'p22-mackinac-pro', serif;
    font-weight: 400;
    font-family: {{ section.settings.who_said_it_font_family }} !important;
    opacity: 1;
  }
  .quote-slide .who_said_it.stars, .actual-quote {    
    opacity: 1;
  }
  .quote-slider-container {
    position: relative;
  }
  .quote-nav {
    margin-top: 1rem;
    text-align: center;
  }
  .quote-nav button {
    background: none;
    border: none;
    font-size: 2rem;
    cursor: pointer;
    color: {{ section.settings.module_accent_color }};
    margin: 0 1rem;
    padding: 0;
    line-height: 1;
  }
  .quote-dots {
    margin-top: 1rem;
    text-align: center;
  }
  .quote-dot {
    display: inline-block;
    height: 0.5rem;
    width: 1rem;
    cursor: pointer;
    border-radius: 1.5rem;
    background-color: {{ section.settings.dots_unselected_color }};
    margin-right: 0.5rem;
  }
  .quote-dot.active {
    background-color: {{ section.settings.module_accent_color }};
  }
  
  @media screen and (max-width: 750px) {                       
    .quote-slide {
      font-size: {{ section.settings.mobile_actual_quote_font_size }};
    }
    {%- if section.settings.hide_quote_on_mobile -%}
      .actual-quote { 
        display: none;
      }
    {%- endif -%}
    .quote-slide .who_said_it {
      font-size: {{ section.settings.mobile_quote_size }};
    }
    .actual-quote {
      margin: 0 auto 2rem;
      text-align: center;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const container = document.querySelector('.quote-slider-container');
    const slides = container.querySelectorAll('.quote-slide');
    const dots = container.querySelectorAll('.quote-dot');
    let current = 0;

    function showSlide(index) {
      slides.forEach((slide, i) => {
        slide.style.display = i === index ? 'block' : 'none';
      });
      dots.forEach((dot, i) => {
        dot.classList.toggle('active', i === index);
      });
      container.dataset.current = index;
    }

    container.querySelector('.quote-prev').addEventListener('click', () => {
      current = (current - 1 + slides.length) % slides.length;
      showSlide(current);
    });

    container.querySelector('.quote-next').addEventListener('click', () => {
      current = (current + 1) % slides.length;
      showSlide(current);
    });

    dots.forEach(dot => {
      dot.addEventListener('click', () => {
        current = parseInt(dot.dataset.index);
        showSlide(current);
      });
    });

    showSlide(current);
  });
</script>


{% schema %}
  {
    "name": "module-tp-image-rows",
    "class": "module-tp-image-rows",
    "settings": [
      {
        "type": "range",
        "id": "padding_top",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "Section Padding Top",
        "default": 0
      },
      {
        "type": "range",
        "id": "padding_bottom",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "Section Padding Buttom",
        "default": 0
      },
      {
        "type": "range",
        "id": "padding_right",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "Section Padding Right",
        "default": 0
      },
      {
        "type": "range",
        "id": "padding_left",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "section Padding Left",
        "default": 0
      }, {
        "type": "range",
        "id": "mobile_padding_top",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "Mobile Section Padding Top",
        "default": 0
      }, {
        "type": "range",
        "id": "mobile_padding_bottom",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "Mobile Section Padding Buttom",
        "default": 0
      }, {
        "type": "range",
        "id": "mobile_padding_right",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "Mobile Section Padding Right",
        "default": 0
      }, {
        "type": "range",
        "id": "mobile_padding_left",
        "min": 0,
        "max": 100,
        "step": 4,
        "unit": "px",
        "label": "Mobile section Padding Left",
        "default": 0
      }, {
        "type": "metaobject",
        "id": "image_gallery",
        "label": "Image Rows Metaobject ",
        "info": "Add a metaobject",
        "metaobject_type": "tp_image_rows"
      }, {
        "type": "metaobject",
        "id": "image_gallery_override",
        "label": "Image Rows Override (optional)",
        "info": "If set, this metaobject is used instead of the main Image Rows metaobject.",
        "metaobject_type": "tp_image_rows"
      }, {
        "type": "text",
        "id": "image_gallery_header",
        "label": "Image Grid Header"
      }, {
        "type": "text",
        "id": "open_close_button",
        "label": "Open Close Button Label"
      }, {
        "type": "color",
        "id": "open_close_button_color",
        "label": "Open Close Button Color"
      }, {
        "type": "text",
        "id": "image_grid_header",
        "label": "Image Grid Header"
      }, {
        "type": "text",
        "id": "keyword_to_remove",
        "label": "Keyword to Remove"
      }, {
        "type": "text",
        "id": "header_font_family",
        "label": "Header Font Family",
        "default": "'p22-mackinac-pro', serif;"
      }, {
        "type": "text",
        "id": "header_font_size",
        "label": "Header Font Size",
        "default": "30px"
      }, {
        "type": "text",
        "id": "header_font_weight",
        "label": "Header Font Weight",
        "default": "400"
      }, {
        "type": "color",
        "id": "header_font_color",
        "label": "Header Font Color",
        "default": "#3C64B1"
      }, {
        "type": "text",
        "id": "image_grid_subheader",
        "label": "Image Grid subheader"
      }, {
        "type": "text",
        "id": "subheader_font_family",
        "label": "subheader Font Family",
        "default": "'p22-mackinac-pro', serif;"
      }, {
        "type": "text",
        "id": "subheader_font_size",
        "label": "subheader Font Size",
        "default": "30px"
      }, {
        "type": "text",
        "id": "subheader_font_weight",
        "label": "subheader Font Weight",
        "default": "400"
      }, {
        "type": "color",
        "id": "subheader_font_color",
        "label": "subheader Font Color",
        "default": "#3C64B1"
      }, {
        "type": "select",
        "id": "header_alignment",
        "label": "Header Alignment",
        "options": [
          {
            "value": "left",
            "label": "Left"
          }, {
            "value": "center",
            "label": "Center"
          }, {
            "value": "right",
            "label": "Right"
          }
        ],
        "default": "center"
      }
    ],
    "presets": [
      {
        "name": "TP Image Rows",
        "category": "Text"
      }
    ]
  }
{% endschema %}
{% if section.settings.image_gallery %}
{%- style -%}
  .section-{{ section.id }}-padding {
    padding: {{ section.settings.padding_top }}px {{ section.settings.padding_right }}px {{ section.settings.padding_bottom }}px {{ section.settings.padding_left }}px;
  }

  @media screen and (max-width: 750px) {
    .section-{{ section.id }}-padding {
      padding: {{ section.settings.mobile_padding_top }}px {{ section.settings.mobile_padding_right }}px {{ section.settings.mobile_padding_bottom }}px {{ section.settings.mobile_padding_left }}px;
    }
  }
{%- endstyle -%}
{% liquid
  assign tp_rows_id = section.settings.image_gallery_override | default: section.settings.image_gallery
  assign tp_rows = nil
  if tp_rows_id != blank
    assign tp_rows = shop.metaobjects.tp_image_rows[tp_rows_id]
  endif
%}
<div class="section-container section-{{ section.id }}-padding">
  <div class="header-content">
    {% if section.settings.image_gallery_header %}
        <h2>
        {{ section.settings.image_gallery_header }}
        </h2>
    {% endif %}
    {% if section.settings.open_close_button and tp_rows.list.value.count > 1  %}
        <button aria-expanded="false">{{ section.settings.open_close_button }}</button>
    {% endif %}
    </div>
    <div id="image_rows_container">
    {% for tp in tp_rows.list.value %}
        {% render 'tp-image-row'
        , my_metaobject: tp
        , index: forloop.index0
        %}
    {% endfor %}
    </div>
</div>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const btn     = document.querySelector('.module-tp-image-rows button');
        const gallery = document.querySelector('#image_rows_container');
        btn.addEventListener('click', () => {
            const isOpen = gallery.classList.toggle('open');
            btn.setAttribute('aria-expanded', String(isOpen));
            btn.textContent = isOpen ? 'Hide Gallery' : 'Show Gallery';
        });
    });
</script>
<style>
.module-tp-image-rows button {
  border: none;
  font-size: 1.4rem;
  padding: 0;
  color: {{ section.settings.open_close_button_color }};  
}
.module-tp-image-rows h2, .module-tp-image-rows button {
    margin: 0 0 12px 0px;
}
#image_rows_container .tp-image-row.isFirst {
  display: grid;
}
#image_rows_container .tp-image-row {
  display: none;
}
#image_rows_container.open .tp-image-row {
  display: grid;
}
</style>
{% endif %}
